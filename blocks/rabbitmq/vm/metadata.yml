name: rabbitmq
version: v3.6.0
resources:
  - service_discovery_service:
      ${instance.id}-rabbitmq:
        Name: ${environment.id}-rabbitmq
        Address: "${d}{var.compute_instance.${instance.name}.privateIp}"
        Port: 5672
        Tags: [ "${instance.id}", "${environment.id}", "messaging" ]
        Check:
          script: "nc ${d}{var.compute_instance.${instance.name}.privateIp} 5672"
          interval: 10s
          timeout: 1s